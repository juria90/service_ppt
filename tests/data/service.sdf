[
  {
    "type": "SymboledDirectory",
    "name": "directories",
    "data": {
      "TEMPLATE_DIR": "/Users/jamesl1/Work/service_ppt/tests/data",
      "SAVE_DIR": "/Users/jamesl1/Work/OnlineService"
    }
  },
  {
    "type": "OpenFile",
    "name": "New File",
    "data": {
      "enabled": true,
      "filename": "",
      "notes_filename": "$(TEMPLATE_DIR)/service-notes-template.txt"
    }
  },
  {
    "type": "InsertSlides",
    "name": "Insert Template Sildes",
    "data": {
      "enabled": true,
      "insert_location": "",
      "separator_slides": "",
      "filelist": [
        "$(TEMPLATE_DIR)/Service-Template.pptx"
      ]
    }
  },
  {
    "type": "DuplicateWithText",
    "name": "Announcement before service",
    "data": {
      "enabled": true,
      "slide_range": "note.contains_text('NOTES_intro_announcement')",
      "repeat_range": "note.contains_text('NOTES_intro_announcement')",
      "find_text": "{intro_announcement}",
      "replace_texts": [
        "Welcome."
      ],
      "preprocessing_script": "",
      "archive_lyric_file": false,
      "optional_line_break": 0,
      "enable_wordwrap": false,
      "wordwrap_font": "",
      "wordwrap_pagewidth": 0
    }
  },
  {
    "type": "SetVariables",
    "name": "Find and replace texts",
    "data": {
      "enabled": true,
      "format_dict": {
        "datetime": {
          "format_type": "DateTimeFormat",
          "value": "2026-02-06"
        }
      },
      "str_dict": {
        "service_title": "Sunday Service",
        "preacher": "Pastor",
        "sermon_title": "Sermon Title",
        "prayer": "Elder Sam"
      }
    }
  },
  {
    "type": "DuplicateWithText",
    "name": "Announcement",
    "data": {
      "enabled": true,
      "slide_range": "note.contains_text('MK_announcement')",
      "repeat_range": "note.contains_text('MK_announcement:repeat')",
      "find_text": "{announcement}",
      "replace_texts": [
        "Welcome."
      ],
      "preprocessing_script": "",
      "archive_lyric_file": false,
      "optional_line_break": 0,
      "enable_wordwrap": false,
      "wordwrap_font": "",
      "wordwrap_pagewidth": 0
    }
  },
  {
    "type": "GenerateBibleVerse",
    "name": "Bible Verse",
    "data": {
      "bible_version1": "개역개정",
      "main_verse_name1": "",
      "each_verse_name1": "",
      "bible_version2": "ESV",
      "main_verse_name2": "",
      "each_verse_name2": "",
      "main_verses": "Genesis 1:1",
      "additional_verses": "Genesis 1:2",
      "repeat_range": "note.contains_text('MK_bible_verse:repeat')"
    }
  },
  {
    "type": "DuplicateWithText",
    "name": "Sermon Summary",
    "data": {
      "enabled": true,
      "slide_range": "note.contains_text('MK_sermon_text')",
      "repeat_range": "note.contains_text('MK_sermon_text:repeat')",
      "find_text": "{sermon_text}",
      "replace_texts": [
        "1. The Creation"
      ],
      "preprocessing_script": "",
      "archive_lyric_file": false,
      "optional_line_break": 0,
      "enable_wordwrap": false,
      "wordwrap_font": "",
      "wordwrap_pagewidth": 0
    }
  },
  {
    "type": "PopupMessage",
    "name": "Check the slides",
    "data": {
      "enabled": true,
      "message": "Please check the slides before continue."
    }
  },
  {
    "type": "SaveFiles",
    "name": "Save the presentation",
    "data": {
      "enabled": true,
      "filename": "$(SAVE_DIR)/{datetime:%Y-%m%d-%A}.pptx",
      "lyrics_archive_filename": "",
      "notes_filename": "$(SAVE_DIR)/service-notes.txt",
      "verses_filename": "$(SAVE_DIR)/bible-verse.txt"
    }
  },
  {
    "type": "ExportSlides",
    "name": "Save introductory announcement",
    "data": {
      "enabled": true,
      "slide_range": "note.contains_text('NOTES_intro_export')",
      "out_dirname": "$(SAVE_DIR)/Slide-Images/0Announce",
      "image_type": "JPEG",
      "flags": 3,
      "color": "#FFFFFF"
    }
  },
  {
    "type": "ExportShapes",
    "name": "Export bible verses to image files",
    "data": {
      "enabled": true,
      "slide_range": "note.contains_text('MK_transparent_bible_verse')",
      "out_dirname": "$(SAVE_DIR)/Slide-Images/1Verse",
      "image_type": "PNG",
      "flags": 1
    }
  },
  {
    "type": "ExportShapes",
    "name": "Export sermon summary to image files",
    "data": {
      "enabled": true,
      "slide_range": "note.contains_text('MK_transparent_sermon_text')",
      "out_dirname": "$(SAVE_DIR)/Slide-Images/2Sermon",
      "image_type": "PNG",
      "flags": 1
    }
  },
  {
    "type": "ExportSlides",
    "name": "Export ending announcement to image files",
    "data": {
      "enabled": true,
      "slide_range": "note.contains_text('MK_closing_announcement')",
      "out_dirname": "$(SAVE_DIR)/Slide-Images/3Ending",
      "image_type": "JPEG",
      "flags": 3,
      "color": "#FFFFFF"
    }
  }
]